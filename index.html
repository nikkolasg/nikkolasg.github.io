<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.15" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title> A blog &middot; A blog </title>

  
  <link rel="stylesheet" href="https://nikkolasg.github.io/css/poole.css">
  <link rel="stylesheet" href="https://nikkolasg.github.io/css/syntax.css">
  <link rel="stylesheet" href="https://nikkolasg.github.io/css/hyde.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  <link href="https://nikkolasg.github.io/index.xml" rel="alternate" type="application/rss+xml" title="A blog" />
</head>

<body class="">

<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="https://nikkolasg.github.io/"><h1>A blog</h1></a>
      <p class="lead">
       Yet another blog on code, security &amp; ideas 
      </p>
    </div>

    <ul class="sidebar-nav">
      <li><a href="/">Home</a> </li>
      
    </ul>

    <p>&copy; 2016. All rights reserved. </p>
  </div>
</div>


    <div class="content container">
<div class="posts">

      
  <div class="post">
    <h1 class="post-title">
      <a href="https://nikkolasg.github.io/pass/">
        Install Pass on different machines with gpg
      </a>
    </h1>

    <span class="post-date">Thu, Mar 3, 2016</span>

    

<h1 id="using-pass-gpg-on-different-machines:cf74d1242aa2a62d59c5375aba5f1401">Using Pass + gpg on different machines</h1>

<p>Piouf, as my first introduction to gpg, that was more complicated than expected.
Pass is a password manager that uses gpg to encrypt your password and can be
intergrated with Git. So as long as you have the same gpg key on your devices,
you can have the passwords in clear text AND being able to push those encrypted
password on any git repo. That&rsquo;s cool !</p>

<h3 id="create-key:cf74d1242aa2a62d59c5375aba5f1401">Create key</h3>

<p><code>gpg --gen-key</code> (it can depends on your distro)
Choose (1) Rsa &amp; Rsa with 4096 bits (at least)</p>

<h3 id="export-key-to-remote-server:cf74d1242aa2a62d59c5375aba5f1401">Export key to remote server</h3>

<p>Notes from <a href="https://www.debuntu.org/how-to-importexport-gpg-key-pair/">https://www.debuntu.org/how-to-importexport-gpg-key-pair/</a></p>

<ul>
<li>Lookup the id of your key: <code>gpg --list-keys</code></li>
<li>Export public key: <code>gpg --output mygpgkey_pub.gpg --armor --export &lt;key-id&gt;</code> where key-id is the
last part when you list the key <code>*****/&lt;key-id&gt;</code></li>
<li>Export secret key : <code>gpg --output mygpgkey_sec.gpg --armor --export-secret-key ******</code></li>
<li>Copy keys to remote server: `scp mygpgkey_pub.gpg mygpgkey_sec.gpg user@remotehost:~/</li>
<li>Connect to remote: <code>ssh user@remotehost</code></li>
<li>Import the public key: <code>gpg --import ~/mygpgkey_pub.gpg</code></li>
<li>Import the secret key: <code>gpg --allow-secret-key-import --import
~/mygpgkey_sec.gpg</code></li>
</ul>

<h2 id="troubles:cf74d1242aa2a62d59c5375aba5f1401">Troubles</h2>

<p>I&rsquo;ve had trouble when importing the key because of pinentry. In Archlinux,
pinentry points to <code>/usr/bin/pintentry-gtk</code> (why &hellip;?). You have to delete the
symlink <code>/usr/bin/pinentry</code> and to point it to whatever (ncurse, or tty if you
work on a remote server)</p>

<h2 id="pass-manager:cf74d1242aa2a62d59c5375aba5f1401">Pass manager</h2>

<p>At this point you can use the Pass manager with the key you created:</p>

<pre><code>pass init &lt;mykey-id&gt;
pass git init
</code></pre>

<p>Then register one password to test if it works</p>

<pre><code>pass insert server/test
</code></pre>

<p>If it <em>fails</em> with <code>There is no assurance this key belongs to the named user</code>,
that mean you have to put a higher level of trust in the key you just imported.
To do that:</p>

<pre><code>gpg --edit-key &lt;mykey-id&gt;
trust
5 (maximum level since it is basically my key)
quit
</code></pre>

<p>Then you can try again to register the password and it should works !</p>

<h2 id="different-machines:cf74d1242aa2a62d59c5375aba5f1401">Different machines</h2>

<p>Now on the remote server you have a git repo in <code>$HOME/.password_store</code>. If you
want your passwords on another machines, make sure you import the key as before.
Then you simply can do:
<code>cd &amp;&amp; git clone user@myserver.com:~/.password-store</code>
Then your local <em>pass</em> will simply look at this file.</p>

<p>Happy password managing &gt;&lt;</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="https://nikkolasg.github.io/install/">
        Install Archlinux on Remote server
      </a>
    </h1>

    <span class="post-date">Tue, Mar 1, 2016</span>

    

<p>After meeting with a bunch of hardcore systems geeks, I decided to put my effort
back into a secure &amp; custom server that I will <em>actually</em> use ;)
 Here&rsquo;s my steps for ArchLinux:</p>

<h1 id="installing-archlinux-on-remote-server:ee40007639ba1d9861b5cc3e7ade0aef">Installing ArchLinux on remote server</h1>

<h2 id="drives:ee40007639ba1d9861b5cc3e7ade0aef">Drives</h2>

<p>First you need to setup your drives correctly. I use fdisk and you can find
any decent tutorial on it easily.
For encrypting one of the partitions, I follow the archlinux guide
(<a href="https://wiki.archlinux.org/index.php/Dm-crypt/Encrypting_a_non-root_file_system">https://wiki.archlinux.org/index.php/Dm-crypt/Encrypting_a_non-root_file_system</a>).
I did not try to encrypt the whole filesystem because it seemed a bit overkill
for my needs. I simply have /dev/sda3 encrypted where all my datas are.</p>

<pre><code>cryptsetup -y -v luksFormat /dev/sda3
cryptsetup open /dev/sda3 cryptroot
mkfs -t ext4 /dev/mapper/cryptroo
</code></pre>

<h2 id="system:ee40007639ba1d9861b5cc3e7ade0aef">System</h2>

<p>For installing on the drives, they need to be unmounted so you need to boot on
&ldquo;rescue&rdquo; image that your hosting provider is surely providing you. Mine was
offering a Debian image.</p>

<p>For the rest of the steps, simply follow the guide on ArchLinux
(<a href="https://wiki.archlinux.org/index.php/Install_from_existing_Linux">https://wiki.archlinux.org/index.php/Install_from_existing_Linux</a>).</p>

<p>The following notes are simply some stuff that kept me crazy during a lot of
hours.</p>

<h2 id="notes:ee40007639ba1d9861b5cc3e7ade0aef">Notes</h2>

<ul>
<li>Install <code>haveged</code> before running <code>pacman-key --init</code>, it&rsquo;ll be WAY much
faster.</li>
<li>DON&rsquo;T forget to copy /etc/resolv.conf from the rescue distribution to the
arhclinux one, or use your own (openDNS forexample).</li>
<li>Change the udev rules so you have <code>eth0</code> instead of .. whatever:
<code>
[root@***** ~]# cat /etc/udev/rules.d/10-network.rules
SUBSYSTEM==&quot;net&quot;, ACTION==&quot;add&quot;, ATTR{address}==&quot;**:**:**:**:**:**&quot;,NAME=&quot;eth0&quot;}
</code>
Then I use netctl (for lxc ease-of-use containers network):
<code>
[root@**** ~]# cat /etc/netctl/ethernet-static
Description='Server ethernet connection'
Interface=eth0
Connection=ethernet
IP=static
Address=('****/24')
Gateway='****'
DNS=('****')
</code></li>
<li>Don&rsquo;t forget to <code>netctl enable ethernet-static</code></li>
<li>Don&rsquo;t forget to <code>systemctl enable sshd</code></li>

<li><p>For non official packages, install yaourt:</p>

<pre><code>[root@****] cat /etc/pacman.conf
# ####
# ...
[archlinuxfr]
SigLevel = Never
Server = http://repo.archlinux.fr/$arch
</code></pre></li>
</ul>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="https://nikkolasg.github.io/about/">
        About Me
      </a>
    </h1>

    <span class="post-date">Wed, Dec 9, 2015</span>

    <p><strong>Since</strong> I&rsquo;ve read so much from other blogs, I thought I should share a bit more,
get out of my confort zone and share some thougts / experiences that may be
useful to others. So here I am, nicolas gailly, a computer scientist guy that likes programming &amp; security.</p>

  </div>
  
</div>
</div>

  </body>
</html>
